<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>23.2 Advanced TypeScript — Deep Learning Note</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css">

  <style>
    :root{--bg:#0b0f10;--surface:#111518;--cyan:#06b6d4;--amber:#f59e0b;--muted:#9aa6a6;--panel-width:340px;--radius:12px}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:var(--bg);color:#e6eef0}
    .app{display:flex;gap:18px;height:100vh;padding:20px}
    .left-panel{width:var(--panel-width);background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.04));padding:18px;border-radius:var(--radius);position:sticky;top:20px;height:calc(100vh - 40px);flex-shrink:0;border:1px solid rgba(255,255,255,0.03)}
    .right-panel{flex:1;background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.00));padding:22px;border-radius:var(--radius);overflow:auto;box-shadow:0 6px 18px rgba(0,0,0,0.6);border:1px solid rgba(255,255,255,0.02)}
    .brand{display:flex;gap:12px;align-items:center}
    .brand-mark{width:46px;height:46px;border-radius:10px;background:linear-gradient(90deg,var(--cyan),var(--amber));display:flex;align-items:center;justify-content:center;color:#071018;font-weight:700}
    .title{font-weight:700}
    .subtitle{font-size:0.82rem;color:var(--muted)}
    .toc{margin-top:12px}
    .search{margin-bottom:10px}
    .controls{display:flex;gap:8px;margin-bottom:8px}
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);padding:6px 8px;border-radius:8px}
    .toc-list{max-height:58vh;overflow:auto;padding-right:6px}
    a.toc-item{display:block;padding:8px;border-radius:8px;margin-bottom:6px;color:inherit;text-decoration:none}
    a.toc-item:hover{background:rgba(255,255,255,0.02);color:var(--cyan)}
    details{background:rgba(255,255,255,0.015);padding:12px;border-radius:10px;margin-bottom:12px;border:1px solid rgba(255,255,255,0.02)}
    summary{cursor:pointer;font-weight:600}
    pre{background:rgba(0,0,0,0.35);padding:12px;border-radius:8px;overflow:auto}
    code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,'Roboto Mono','Courier New',monospace}
    h1,h2,h3{color:#dff7fb}
    p{color:#cfe8ea}
    .muted{color:var(--muted)}
    @media (max-width:900px){.left-panel{display:none}}
  </style>
</head>
<body>
  <div class="app container-fluid">
    <aside class="left-panel" aria-label="Table of contents">
      <div class="brand">
        <div class="brand-mark">23.2</div>
        <div>
          <div class="title">Advanced TypeScript</div>
          <div class="subtitle">Conditional, Mapped, Template literal, Utility & Declaration merging</div>
        </div>
      </div>
      <div style="margin-top:12px;display:flex;justify-content:space-between;align-items:center">
        <div class="muted">Author: <strong>Irfan</strong></div>
        <div style="background:linear-gradient(90deg,var(--cyan),rgba(0,0,0,0.12));padding:4px 8px;border-radius:999px;color:#021417;font-weight:700">Advanced</div>
      </div>

      <div class="toc">
        <input id="tocSearch" class="form-control search" placeholder="Search TOC..." />
        <div class="controls">
          <button class="btn-ghost" id="expandAll">Expand all</button>
          <button class="btn-ghost" id="collapseAll">Collapse all</button>
          <button class="btn-ghost" id="tocReset">Reset</button>
        </div>
        <div class="toc-list" id="tocList">
          <a class="toc-item" href="#conditional">Conditional Types</a>
          <a class="toc-item" href="#mapped">Mapped Types</a>
          <a class="toc-item" href="#template">Template Literal Types</a>
          <a class="toc-item" href="#utility">Utility Types</a>
          <a class="toc-item" href="#declaration">Declaration Merging</a>
          <a class="toc-item" href="#patterns">Design Patterns & Tips</a>
        </div>
      </div>
    </aside>

    <main class="right-panel" id="content" tabindex="0">
      <article>
        <h1 id="top">23.2 Advanced TypeScript — Deep Learning Note</h1>
        <p class="muted">Deep, example-focused exploration of advanced TypeScript type-system features: conditional, mapped, template literal types, standard utility types, and declaration merging. Code blocks are safe for browser render. Use TOC for navigation and expand/collapse sections for layered study.</p>

        <!-- CONDITIONAL -->
        <section id="conditional" class="anchor-target">
          <h2>Conditional Types</h2>

          <details open>
            <summary>Executive summary</summary>
            <p>Conditional types select a type branch based on a compile-time condition. They are similar to ternary expressions but operate on types and can be distributive over unions.</p>
          </details>

          <details>
            <summary>Basic syntax & example</summary>
            <pre><code class="language-typescript">type IsString&lt;T&gt; = T extends string ? true : false;

type A = IsString&lt;string&gt;; // true
type B = IsString&lt;number&gt;; // false
</code></pre>
          </details>

          <details>
            <summary>Distributive conditional types</summary>
            <p>When the checked type is a naked type parameter, conditional types distribute over unions.</p>
            <pre><code class="language-typescript">type ToArray&lt;T&gt; = T extends any ? T[] : never;

type R = ToArray&lt;string | number&gt;; // string[] | number[]
</code></pre>
          </details>

          <details>
            <summary>Use-cases: type filtering & extracting</summary>
            <pre><code class="language-typescript">type ExtractFunctionProps&lt;T&gt; = T extends (...args: infer A) =&gt; any ? A : never;

type Fn = (a: number, b: string) =&gt; void;
type Args = ExtractFunctionProps&lt;Fn&gt;; // [number, string]
</code></pre>
          </details>

          <details>
            <summary>Pitfalls & best practices</summary>
            <ul>
              <li>Watch for unexpected distributive behavior; wrap the type in a tuple to prevent distribution.</li>
              <li>Use <code>infer</code> for extracting types from structures (e.g., unwrap Promise).</li>
            </ul>
            <pre><code class="language-typescript">// prevent distribution
type NotDistribute&lt;T&gt; = [T] extends [string | number] ? 'yes' : 'no';
</code></pre>
          </details>
        </section>

        <hr />

        <!-- MAPPED -->
        <section id="mapped" class="anchor-target">
          <h2>Mapped Types</h2>

          <details open>
            <summary>Executive summary</summary>
            <p>Mapped types create new types by mapping over keys of another type. They power utility types like <code>Partial</code>, <code>Readonly</code>, and enable transformation patterns.</p>
          </details>

          <details>
            <summary>Basic mapped type</summary>
            <pre><code class="language-typescript">type Readonly&lt;T&gt; = { readonly [K in keyof T]: T[K] };

type Partial&lt;T&gt; = { [K in keyof T]?: T[K] };
</code></pre>
          </details>

          <details>
            <summary>Mapping modifiers and key remapping (TS 4.1+)</summary>
            <pre><code class="language-typescript">type RemovePrefix&lt;T extends string&gt; = T extends `on${infer Rest}` ? Rest : T;

type Events = { onClick: 'click', onHover: 'hover' };

type ShortEvents = { [K in keyof Events as RemovePrefix&lt;Extract&lt;K, string&gt;&gt;]: Events[K] };
// Result: { Click: 'click', Hover: 'hover' }
</code></pre>
          </details>

          <details>
            <summary>Practical example: deep partial</summary>
            <pre><code class="language-typescript">type DeepPartial&lt;T&gt; = {
  [K in keyof T]?: T[K] extends object ? DeepPartial&lt;T[K]&gt; : T[K]
};
</code></pre>
          </details>
        </section>

        <hr />

        <!-- TEMPLATE LITERAL -->
        <section id="template" class="anchor-target">
          <h2>Template Literal Types</h2>

          <details open>
            <summary>Executive summary</summary>
            <p>Template literal types allow building string-like types using unions and literal types. They are powerful for modeling string patterns (e.g., CSS properties, routes, event names).</p>
          </details>

          <details>
            <summary>Examples</summary>
            <pre><code class="language-typescript">type Direction = 'up' | 'down' | 'left' | 'right';
type ClassName&lt;T extends string&gt; = `icon-${T}`;

type Icon = ClassName&lt;Direction&gt;; // 'icon-up' | 'icon-down' | 'icon-left' | 'icon-right'
</code></pre>
          </details>

          <details>
            <summary>Use-case: typed routes</summary>
            <pre><code class="language-typescript">type Route = '/users' | '/posts' | '/users/${string}';

function navigate(path: Route) {}

navigate('/users');
// navigate('/unknown'); // Type error
</code></pre>
          </details>

          <details>
            <summary>Combining with conditional & mapped types</summary>
            <pre><code class="language-typescript">type PrefixKeys&lt;T&gt; = { [K in keyof T as `on${Capitalize&lt;string &amp; K&gt;}`]: T[K] };
</code></pre>
          </details>
        </section>

        <hr />

        <!-- UTILITY TYPES -->
        <section id="utility" class="anchor-target">
          <h2>Utility Types</h2>

          <details open>
            <summary>Executive summary</summary>
            <p>TypeScript ships many utility types to transform types: <code>Partial</code>, <code>Required</code>, <code>Pick</code>, <code>Omit</code>, <code>Record</code>, <code>Exclude</code>, <code>Extract</code>, <code>ReturnType</code>, <code>Parameters</code>, and more. Know them to avoid reinventing wheels.</p>
          </details>

          <details>
            <summary>Common utilities and examples</summary>
            <pre><code class="language-typescript">type User = { id: number; name?: string; role: 'admin' | 'user' };

type T1 = Partial&lt;User&gt;; // all optional
type T2 = Required&lt;User&gt;; // all required
type T3 = Pick&lt;User, 'id' | 'name'&gt;;
type T4 = Omit&lt;User, 'role'&gt;;

type Fn = (a: number) =&gt; string;
type R = ReturnType&lt;Fn&gt;; // string
type P = Parameters&lt;Fn&gt;; // [number]
</code></pre>
          </details>

          <details>
            <summary>Custom utility example: MakePropertiesMutable</summary>
            <pre><code class="language-typescript">type MakeMutable&lt;T&gt; = { -readonly [K in keyof T]: T[K] };
</code></pre>
          </details>
        </section>

        <hr />

        <!-- DECLARATION MERGING -->
        <section id="declaration" class="anchor-target">
          <h2>Declaration Merging</h2>

          <details open>
            <summary>Executive summary</summary>
            <p>Declaration merging lets multiple declarations with the same name merge into a single definition — particularly useful for augmenting interfaces (e.g., global Window) or module augmentation for third-party libs.</p>
          </details>

          <details>
            <summary>Interface merging example</summary>
            <pre><code class="language-typescript">interface User { id: number }
interface User { name: string }

// merged: User has id and name
</code></pre>
          </details>

          <details>
            <summary>Module augmentation example</summary>
            <pre><code class="language-typescript">// augmenting Express Request
import 'express';

declare module 'express' {
  interface Request { user?: { id: string } }
}
</code></pre>
          </details>

          <details>
            <summary>Caution & alternatives</summary>
            <p>Merging is powerful but can lead to surprising global changes. Prefer explicit module augmentation files and keep augmentations localized under <code>types/</code> folder.</p>
          </details>
        </section>

        <hr />

        <!-- PATTERNS -->
        <section id="patterns" class="anchor-target">
          <h2>Design Patterns &amp; Tips</h2>

          <details open>
            <summary>Guidelines for complex type systems</summary>
            <ul>
              <li>Favor readability: complex types are powerful but can hurt maintainability.</li>
              <li>Document advanced types with examples and comments.</li>
              <li>Use tests (tsd, dtslint) to assert type behaviour for libraries.</li>
              <li>Limit type-level recursion depth to avoid compiler performance issues.</li>
            </ul>
          </details>

          <details>
            <summary>Example: testing types with tsd</summary>
            <pre><code class="language-bash"># install tsd
npm install -D tsd

# example test: index.test-d.ts
import { expectType } from 'tsd';
expectType&lt;string&gt;(myFunction('a'));
</code></pre>
          </details>
        </section>

        <footer style="margin-top:20px;padding-bottom:40px;">
          <p class="muted">End of note. Use the left TOC to navigate and expand/collapse sections. Want me to expand any section into deeper worked examples (e.g., building a typed ORM layer, advanced template type metaprogramming, or a d.ts authoring guide)? Specify which and I'll update the same file.</p>
        </footer>
      </article>
    </main>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/typescript.min.js"></script>
  <script>
    if(window.hljs){ hljs.highlightAll(); }

    document.querySelectorAll('#tocList a').forEach(a=>{
      a.addEventListener('click', function(e){ e.preventDefault(); const id=this.getAttribute('href').slice(1); const el=document.getElementById(id); if(el){ el.scrollIntoView({behavior:'smooth',block:'start'}); const d=el.querySelector('details'); if(d && !d.open) d.open=true; } });
    });

    document.getElementById('expandAll').addEventListener('click', ()=> document.querySelectorAll('details').forEach(d=> d.open=true));
    document.getElementById('collapseAll').addEventListener('click', ()=> document.querySelectorAll('details').forEach(d=> d.open=false));
    document.getElementById('tocReset').addEventListener('click', ()=> document.getElementById('content').scrollTo({top:0,behavior:'smooth'}));

    document.getElementById('tocSearch').addEventListener('input', ()=>{ const q=document.getElementById('tocSearch').value.trim().toLowerCase(); document.querySelectorAll('#tocList a').forEach(a=>{ a.style.display = a.textContent.toLowerCase().includes(q) ? 'block' : 'none'; }); });

    document.addEventListener('keydown',(e)=>{ if(e.key==='E' || e.key==='e') document.querySelectorAll('details').forEach(d=> d.open=true); if(e.key==='C' || e.key==='c') document.querySelectorAll('details').forEach(d=> d.open=false); });
  </script>
</body>
</html>