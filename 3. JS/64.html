<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>19.1 Creational Patterns — Singleton, Factory, Builder, Prototype, Module (JavaScript)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css">
  <style>
    :root{--bg:#0d1117;--surface:#0f1724;--muted:#9ca3af;--cyan:#06b6d4;--amber:#f59e0b;--panel-width:360px;--radius:12px;--mono:ui-monospace,SFMono-Regular,Menlo,Monaco,'Roboto Mono','Courier New',monospace}
    html,body{height:100%;background:var(--bg);color:#e6eef6;font-family:Inter, system-ui, -apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;margin:0}
    .app{display:flex;height:100vh;gap:20px;padding:20px;box-sizing:border-box}
    .left{width:var(--panel-width);min-width:260px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border-radius:var(--radius);padding:18px;box-shadow:0 6px 18px rgba(2,6,23,0.7);position:sticky;top:20px;height:calc(100vh - 40px);overflow:auto}
    .right{flex:1;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border-radius:var(--radius);padding:28px;box-shadow:0 6px 18px rgba(2,6,23,0.7);height:calc(100vh - 40px);overflow:auto}
    h1,h2,h3{color:#fff}
    .muted{color:var(--muted)}
    .toc-search{display:flex;gap:8px;margin-bottom:12px}
    .toc-list{list-style:none;padding:0;margin:0}
    .toc-item{padding:8px 10px;border-radius:8px;cursor:pointer}
    .toc-item:hover{background:rgba(255,255,255,0.02)}
    pre{background:rgba(255,255,255,0.02);padding:14px;border-radius:10px;overflow:auto;font-family:var(--mono);font-size:13px}
    code{font-family:var(--mono);font-size:13px}
    details{background:rgba(255,255,255,0.01);margin:10px 0;padding:10px;border-radius:8px}
    details[open]{box-shadow:0 8px 24px rgba(2,6,23,0.7)}
    summary{cursor:pointer;outline:none;padding:6px 8px;border-radius:6px}
    summary::-webkit-details-marker{display:none}
    .summary-title{display:flex;align-items:center;gap:10px}
    .pill{padding:2px 8px;border-radius:999px;background:rgba(245,158,11,0.12);color:var(--amber);font-size:12px}
    .section{padding-top:8px;margin-top:8px;border-top:1px dashed rgba(255,255,255,0.03)}
    .highlight{background:linear-gradient(90deg, rgba(6,182,212,0.06), transparent);}
    .controls{display:flex;gap:8px;margin-bottom:12px}
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
    .pattern-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:900px){.app{flex-direction:column;padding:12px}.left{width:100%;position:relative;height:auto}.right{height:auto}.pattern-grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="app container-fluid">
    <aside class="left">
      <div class="d-flex align-items-start mb-3">
        <div>
          <h4 class="mb-0">19.1 Creational Patterns</h4>
          <div class="muted">Singleton, Factory, Builder, Prototype, Module — JavaScript</div>
          <div class="mt-2"><small class="muted">Author: Advanced JS Tutor • Updated: Nov 28, 2025</small></div>
        </div>
      </div>

      <div class="toc-search">
        <input id="tocSearch" class="form-control form-control-sm" placeholder="Search TOC..." aria-label="Search table of contents"/>
        <button id="tocClear" class="btn btn-sm btn-outline-secondary">Clear</button>
      </div>

      <div class="controls">
        <button id="expandAll" class="btn btn-sm btn-primary">Expand all</button>
        <button id="collapseAll" class="btn btn-sm btn-ghost">Collapse all</button>
        <button id="tocCollapse" class="btn btn-sm btn-ghost">Collapse TOC</button>
      </div>

      <nav>
        <ul id="tocList" class="toc-list">
          <li class="toc-item" data-target="intro">Introduction &amp; Exec Summary</li>
          <li class="toc-item" data-target="singleton">Singleton Pattern</li>
          <li class="toc-item" data-target="factory">Factory Pattern</li>
          <li class="toc-item" data-target="builder">Builder Pattern</li>
          <li class="toc-item" data-target="prototype">Prototype Pattern</li>
          <li class="toc-item" data-target="module">Module Pattern &amp; Variations</li>
          <li class="toc-item" data-target="comparison">Comparison &amp; When to use</li>
          <li class="toc-item" data-target="examples">Examples &amp; Cheatsheet</li>
        </ul>
      </nav>
    </aside>

    <main class="right" id="content">
      <section id="intro" class="section">
        <h2>Introduction &amp; Executive Summary <span class="pill">Quick</span></h2>
        <details open>
          <summary><div class="summary-title"><strong>Executive summary</strong><span class="muted">(short)</span></div></summary>
          <div class="mt-2 muted">Creational design patterns abstract and encapsulate object creation, making code more flexible, testable, and maintainable. This module examines five key creational patterns in JavaScript: Singleton, Factory, Builder, Prototype, and Module. We'll show clear idiomatic JavaScript implementations, trade-offs, and real-world use cases.</div>
        </details>

        <details>
          <summary><div class="summary-title"><strong>Why this matters</strong></div></summary>
          <div class="mt-2">Good object creation strategies reduce coupling, simplify testing, and make it easier to change implementations without rewriting callers. These patterns also help when building libraries, SDKs, or complex apps requiring controlled instantiation or object configuration.</div>
        </details>
      </section>

      <section id="singleton" class="section">
        <h3>Singleton Pattern</h3>
        <details>
          <summary><div class="summary-title"><strong>Intent</strong></div></summary>
          <div class="mt-2">Ensure a class or module has only one instance and provide a global access point. Useful for shared resources like configuration, logging, or a single cache manager.</div>
        </details>

        <details>
          <summary><div class="summary-title"><strong>Vanilla JS implementation</strong></div></summary>
          <div class="mt-2">Use closures to encapsulate the instance reference and expose a getInstance API.</div>
          <pre><code>&lt;!-- singleton.js --&gt;
const Logger = (function(){
  let instance = null;
  function create(){
    return {
      logs: [],
      log(msg){ this.logs.push(msg); console.log(msg); }
    };
  }
  return {
    getInstance(){ if(!instance) instance = create(); return instance; }
  };
})();

// usage
const a = Logger.getInstance();
a.log('hello');
const b = Logger.getInstance();
console.log(a === b); // true
</code></pre>
        </details>

        <details>
          <summary><div class="summary-title"><strong>When to avoid</strong></div></summary>
          <div class="mt-2">Singletons can hide dependencies and make testing harder. Prefer dependency injection for larger apps; use singletons sparingly for truly global resources.</div>
        </details>
      </section>

      <section id="factory" class="section">
        <h3>Factory Pattern</h3>
        <details>
          <summary><div class="summary-title"><strong>Intent</strong></div></summary>
          <div class="mt-2">Encapsulate object creation logic and return objects from a factory function. This centralizes construction, supports polymorphism, and allows returning different concrete types based on input.</div>
        </details>

        <details>
          <summary><div class="summary-title"><strong>Simple factory example</strong></div></summary>
          <div class="mt-2">
            <pre><code>// factory.js
function createShape(type, opts){
  switch(type){
    case 'circle': return { type: 'circle', radius: opts.radius };
    case 'rect': return { type: 'rect', width: opts.w, height: opts.h };
    default: throw new Error('unknown');
  }
}

const c = createShape('circle', { radius: 10 });
</code></pre>
          </div>
        </details>

        <details>
          <summary><div class="summary-title"><strong>Factory with classes &amp; polymorphism</strong></div></summary>
          <div class="mt-2">
            <pre><code>// polymorphic factory
class Circle{ constructor(radius){ this.radius = radius } }
class Rect{ constructor(w,h){ this.w=w; this.h=h } }
function shapeFactory(type, opts){
  if(type === 'circle') return new Circle(opts.radius);
  if(type === 'rect') return new Rect(opts.w, opts.h);
}
</code></pre>
          </div>
        </details>

        <details>
          <summary><div class="summary-title"><strong>Advantages</strong></div></summary>
          <div class="mt-2">Decouples clients from concrete implementations; simplifies tests by mocking factory outputs.</div>
        </details>
      </section>

      <section id="builder" class="section">
        <h3>Builder Pattern</h3>
        <details>
          <summary><div class="summary-title"><strong>Intent</strong></div></summary>
          <div class="mt-2">Construct complex objects step-by-step using a fluent API. Useful when an object has many optional parameters or complex construction logic.</div>
        </details>

        <details>
          <summary><div class="summary-title"><strong>Fluent builder example</strong></div></summary>
          <div class="mt-2">
            <pre><code>// builder.js
class UserBuilder{
  constructor(){ this.data = {}; }
  name(n){ this.data.name = n; return this; }
  email(e){ this.data.email = e; return this; }
  role(r){ this.data.role = r; return this; }
  build(){ return Object.freeze({ ...this.data }); }
}

const user = new UserBuilder().name('Irfan').email('i@example.com').role('admin').build();
</code></pre>
          </div>
        </details>

        <details>
          <summary><div class="summary-title"><strong>When to use</strong></div></summary>
          <div class="mt-2">Use builder when constructors with many parameters hurt readability; builders are also easy to test and validate before finalizing object creation.</div>
        </details>
      </section>

      <section id="prototype" class="section">
        <h3>Prototype Pattern</h3>
        <details>
          <summary><div class="summary-title"><strong>Intent</strong></div></summary>
          <div class="mt-2">Create new objects by cloning a prototype object. In JS this aligns well with prototypal inheritance and <code>Object.create()</code>. Useful for runtime object specialization without classes.</div>
        </details>

        <details>
          <summary><div class="summary-title"><strong>Prototype cloning example</strong></div></summary>
          <div class="mt-2">
            <pre><code>// prototype.js
const carProto = {
  drive(){ console.log('driving', this.model); }
};

const car1 = Object.create(carProto);
car1.model = 'A';
const car2 = Object.create(carProto);
car2.model = 'B';
car1.drive(); // driving A
</code></pre>
          </div>
        </details>

        <details>
          <summary><div class="summary-title"><strong>Prototype vs class</strong></div></summary>
          <div class="mt-2">JavaScript classes are syntactic sugar over prototypes. Use prototypes for lightweight object graphs and when you want fast cloning with shared behavior.</div>
        </details>
      </section>

      <section id="module" class="section">
        <h3>Module Pattern &amp; Variations</h3>
        <details>
          <summary><div class="summary-title"><strong>Intent</strong></div></summary>
          <div class="mt-2">Encapsulate private state and expose a public API. Modules are excellent for organizing code, implementing singletons, and separating concerns. ES Modules (import/export) are the modern standard; immediately-invoked function expressions (IIFE) represent older patterns.</div>
        </details>

        <details>
          <summary><div class="summary-title"><strong>IIFE module (classic)</strong></div></summary>
          <div class="mt-2">
            <pre><code>// classic module
const Counter = (function(){
  let count = 0;
  return {
    inc(){ count++; return count; },
    dec(){ count--; return count; },
    get(){ return count; }
  };
})();
</code></pre>
          </div>
        </details>

        <details>
          <summary><div class="summary-title"><strong>ES Module (modern)</strong></div></summary>
          <div class="mt-2">
            <pre><code>// counter.js
let count = 0;
export function inc(){ return ++count; }
export function get(){ return count; }
// import { inc, get } from './counter.js';
</code></pre>
          </div>
        </details>
      </section>

      <section id="comparison" class="section">
        <h3>Comparison &amp; When to Use Which</h3>
        <details>
          <summary><div class="summary-title"><strong>Decision guide</strong></div></summary>
          <div class="mt-2">
            <ul>
              <li><strong>Singleton</strong>: when you truly need one shared instance (logger, config). Prefer DI if possible.</li>
              <li><strong>Factory</strong>: when you need to encapsulate creation logic and return different types.</li>
              <li><strong>Builder</strong>: for complex objects with optional params and validations.</li>
              <li><strong>Prototype</strong>: for cloning and lightweight inheritance; when you want fast instance creation with shared behavior.</li>
              <li><strong>Module</strong>: general code organization and encapsulation; use ES Modules for modern apps.</li>
            </ul>
          </div>
        </details>
      </section>

      <section id="examples" class="section">
        <h3>Examples &amp; Cheatsheet</h3>
        <details>
          <summary><div class="summary-title"><strong>Example: combining patterns (Builder + Factory)</strong></div></summary>
          <div class="mt-2">
            <pre><code>// combined.js
class ConfigBuilder{
  constructor(){ this.c = {}; }
  setHost(h){ this.c.host = h; return this; }
  setPort(p){ this.c.port = p; return this; }
  enableTLS(b){ this.c.tls = b; return this; }
  build(){ return Object.freeze(this.c); }
}

function createClient(type, config){
  const cfg = config || new ConfigBuilder().setHost('localhost').setPort(80).build();
  if(type === 'http') return new HttpClient(cfg);
  if(type === 'ws') return new WebSocketClient(cfg);
}
</code></pre>
          </div>
        </details>

        <details>
          <summary><div class="summary-title"><strong>Testing tips</strong></div></summary>
          <div class="mt-2">Avoid hard-coded singletons in tests — expose a way to reset or inject instances. Use factories to generate test doubles. Builders simplify creation of complex test fixtures.</div>
        </details>

        <details>
          <summary><div class="summary-title"><strong>Cheat sheet</strong></div></summary>
          <div class="mt-2">
            <ul>
              <li>Use <code>Object.create(proto)</code> for prototype-based clones.</li>
              <li>Use closures for simple singletons / modules.</li>
              <li>Use factories to centralize creation logic and improve testability.</li>
              <li>Use builders for readable construction of complex objects.</li>
              <li>Prefer ES Modules for modular code; use DI in larger apps.</li>
            </ul>
          </div>
        </details>
      </section>

      <footer class="mt-4 muted"><small>Designed for students from college to PhD. Want UML diagrams, class diagrams, or live interactive examples, say which one and I'll add it. — Advanced JS Tutor</small></footer>
    </main>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
  <script>
    // TOC interactions, search, expand/collapse, smooth scroll
    document.querySelectorAll('.toc-item').forEach(item =&gt; {
      item.addEventListener('click', () =&gt; {
        const target = document.getElementById(item.dataset.target);
        if(target){
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
          document.querySelectorAll('.section').forEach(s =&gt; s.classList.remove('highlight'));
          target.classList.add('highlight');
          setTimeout(() =&gt; target.classList.remove('highlight'), 1400);
        }
      });
    });

    const tocSearch = document.getElementById('tocSearch');
    const tocList = document.getElementById('tocList');
    tocSearch.addEventListener('input', (e) =&gt; {
      const q = e.target.value.trim().toLowerCase();
      Array.from(tocList.children).forEach(li =&gt; {
        const text = li.textContent.trim().toLowerCase();
        li.style.display = text.includes(q) ? '' : 'none';
      });
    });
    document.getElementById('tocClear').addEventListener('click', () =&gt; { tocSearch.value=''; tocSearch.dispatchEvent(new Event('input')); });

    function setAll(open){ document.querySelectorAll('main details').forEach(d =&gt; { d.open = open; }); }
    document.getElementById('expandAll').addEventListener('click', () =&gt; setAll(true));
    document.getElementById('collapseAll').addEventListener('click', () =&gt; setAll(false));

    document.getElementById('tocCollapse').addEventListener('click', () =&gt; {
      const left = document.querySelector('.left');
      if(left.style.width === '64px'){ left.style.width = getComputedStyle(document.documentElement).getPropertyValue('--panel-width'); }
      else { left.style.width = '64px'; }
    });

    document.addEventListener('DOMContentLoaded', (ev) =&gt; {
      if(window.hljs) hljs.highlightAll();
    });
  </script>
</body>
</html>