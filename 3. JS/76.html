<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>22.2 Build Tools & Bundlers — Deep Learning Note</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css">

  <style>
    :root{--bg:#0b0f10;--surface:#111518;--cyan:#06b6d4;--amber:#f59e0b;--muted:#9aa6a6;--panel-width:340px;--radius:12px}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:var(--bg);color:#e6eef0}
    .app{display:flex;gap:18px;height:100vh;padding:20px}
    .left-panel{width:var(--panel-width);background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.04));padding:18px;border-radius:var(--radius);position:sticky;top:20px;height:calc(100vh - 40px);flex-shrink:0;border:1px solid rgba(255,255,255,0.03)}
    .right-panel{flex:1;background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.00));padding:22px;border-radius:var(--radius);overflow:auto;box-shadow:0 6px 18px rgba(0,0,0,0.6);border:1px solid rgba(255,255,255,0.02)}
    .brand{display:flex;gap:12px;align-items:center}
    .brand-mark{width:46px;height:46px;border-radius:10px;background:linear-gradient(90deg,var(--cyan),var(--amber));display:flex;align-items:center;justify-content:center;color:#071018;font-weight:700}
    .title{font-weight:700}
    .subtitle{font-size:0.82rem;color:var(--muted)}
    .toc{margin-top:12px}
    .search{margin-bottom:10px}
    .controls{display:flex;gap:8px;margin-bottom:8px}
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);padding:6px 8px;border-radius:8px}
    .toc-list{max-height:58vh;overflow:auto;padding-right:6px}
    a.toc-item{display:block;padding:8px;border-radius:8px;margin-bottom:6px;color:inherit;text-decoration:none}
    a.toc-item:hover{background:rgba(255,255,255,0.02);color:var(--cyan)}
    details{background:rgba(255,255,255,0.015);padding:12px;border-radius:10px;margin-bottom:12px;border:1px solid rgba(255,255,255,0.02)}
    summary{cursor:pointer;font-weight:600}
    pre{background:rgba(0,0,0,0.35);padding:12px;border-radius:8px;overflow:auto}
    code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,'Roboto Mono','Courier New',monospace}
    h1,h2,h3{color:#dff7fb}
    p{color:#cfe8ea}
    .muted{color:var(--muted)}
    @media (max-width:900px){.left-panel{display:none}}
  </style>
</head>
<body>
  <div class="app container-fluid">
    <aside class="left-panel" aria-label="Table of contents">
      <div class="brand">
        <div class="brand-mark">22.2</div>
        <div>
          <div class="title">Build Tools & Bundlers</div>
          <div class="subtitle">Webpack, Rollup, Parcel, Vite, ESBuild — deep note</div>
        </div>
      </div>
      <div style="margin-top:12px;display:flex;justify-content:space-between;align-items:center">
        <div class="muted">Author: <strong>Irfan</strong></div>
        <div style="background:linear-gradient(90deg,var(--cyan),rgba(0,0,0,0.12));padding:4px 8px;border-radius:999px;color:#021417;font-weight:700">Advanced</div>
      </div>

      <div class="toc">
        <input id="tocSearch" class="form-control search" placeholder="Search TOC..." />
        <div class="controls">
          <button class="btn-ghost" id="expandAll">Expand all</button>
          <button class="btn-ghost" id="collapseAll">Collapse all</button>
          <button class="btn-ghost" id="tocReset">Reset</button>
        </div>
        <div class="toc-list" id="tocList">
          <a class="toc-item" href="#webpack">Webpack: configuration & optimization</a>
          <a class="toc-item" href="#rollup">Rollup: library bundling</a>
          <a class="toc-item" href="#parcel">Parcel: zero-config</a>
          <a class="toc-item" href="#vite">Vite: fast development</a>
          <a class="toc-item" href="#esbuild">ESBuild: speed-first</a>
          <a class="toc-item" href="#comparisons">Comparisons & when to choose</a>
          <a class="toc-item" href="#bestpractices">Best practices & checklist</a>
        </div>
      </div>
    </aside>

    <main class="right-panel" id="content" tabindex="0">
      <article>
        <h1 id="top">22.2 Build Tools & Bundlers — Deep Learning Note</h1>
        <p class="muted">This single-file note explains config, optimization strategies, plugin ecosystems and real-world trade-offs for Webpack, Rollup, Parcel, Vite and ESBuild. Code examples use HTML entities so browsers render correctly. Use the TOC to navigate.</p>

        <!-- WEBPACK -->
        <section id="webpack" class="anchor-target">
          <h2>Webpack — configuration & optimization</h2>

          <details open>
            <summary>Executive summary</summary>
            <p>Webpack is a powerful, highly-configurable bundler with a vast plugin/loader ecosystem. It supports loaders (transform files), plugins (hook into lifecycle), code splitting, long-term caching and advanced optimizations. Use it when you need fine-grained control over production builds.</p>
          </details>

          <details>
            <summary>Core concepts: entry, output, loaders, plugins, mode</summary>
            <ul>
              <li><code>entry</code> — starting point(s) for the graph.</li>
              <li><code>output</code> — filename pattern, path, publicPath.</li>
              <li><code>loaders</code> — transform non-JS assets (Babel, CSS, images).</li>
              <li><code>plugins</code> — perform optimizations, inject envs, analyze bundles.</li>
              <li><code>mode</code> — <code>development</code> vs <code>production</code> toggles built-in optimizations.</li>
            </ul>
          </details>

          <details>
            <summary>Minimal Webpack config (entry + output + babel loader)</summary>
            <pre><code class="language-javascript">// webpack.config.js
const path = require('path');
module.exports = {
  mode: 'production',
  entry: './src/index.js',
  output: {
    filename: 'bundle.[contenthash].js',
    path: path.resolve(__dirname, 'dist'),
    publicPath: '/assets/'
  },
  module: {
    rules: [
      { test: /\.m?js$/, exclude: /node_modules/, use: { loader: 'babel-loader' } },
      { test: /\.css$/, use: ['style-loader','css-loader'] }
    ]
  },
  plugins: []
};
</code></pre>
          </details>

          <details>
            <summary>Optimization techniques</summary>
            <ol>
              <li><strong>Content hashing:</strong> use <code>[contenthash]</code> in filenames for cache busting.</li>
              <li><strong>SplitChunks:</strong> extract vendor &amp; common code into separate chunks.</li>
              <li><strong>Tree shaking:</strong> ensure ESM input and set <code>sideEffects:false</code> in package.json.</li>
              <li><strong>Minification:</strong> TerserPlugin, keep class names or drop comments when safe.</li>
              <li><strong>Asset optimization:</strong> image compression, inlining small assets with url-loader or asset modules.</li>
              <li><strong>Bundle analyzer:</strong> webpack-bundle-analyzer to inspect bundle composition.</li>
            </ol>
          </details>

          <details>
            <summary>SplitChunks example configuration</summary>
            <pre><code class="language-javascript">// inside webpack.config.js
optimization: {
  splitChunks: {
    chunks: 'all',
    cacheGroups: {
      vendors: { test: /[\\/]node_modules[\\/]/, name: 'vendors', chunks: 'all' },
      commons: { minSize: 0, minChunks: 2, name: 'commons' }
    }
  },
  runtimeChunk: { name: 'runtime' }
}
</code></pre>
          </details>

          <details>
            <summary>Performance tips</summary>
            <ul>
              <li>Use <code>cache: {type: 'filesystem'}</code> to speed up rebuilds.</li>
              <li>Enable <code>parallel</code> processing for loaders/plugins that support it.</li>
              <li>Prefer <code>esbuild-loader</code> or <code>swc-loader</code> for faster transpilation.</li>
              <li>Limit the number of entry points and avoid huge synchronous imports on init.</li>
            </ul>
          </details>

          <details>
            <summary>Real-world example: library vs app builds</summary>
            <p>For libraries, prefer Rollup (smaller outputs) or configure Webpack to produce multiple targets (UMD, ESM, CJS). For apps, Webpack remains a feature-rich choice where fine control over caching and chunking matters.</p>
          </details>
        </section>

        <hr />

        <!-- ROLLUP -->
        <section id="rollup" class="anchor-target">
          <h2>Rollup — library bundling</h2>

          <details open>
            <summary>Executive summary</summary>
            <p>Rollup excels at producing small, optimized bundles for libraries. It uses ES module semantics to enable superior tree-shaking. Plugins handle non-JS assets and transpilation. Use Rollup for publishing libraries that need clean ESM output.</p>
          </details>

          <details>
            <summary>Core config (input, output, plugins)</summary>
            <pre><code class="language-javascript">// rollup.config.js
import resolve from '@rollup/plugin-node-resolve';
import commonjs from '@rollup/plugin-commonjs';
import { terser } from 'rollup-plugin-terser';

export default {
  input: 'src/index.js',
  output: [
    { file: 'dist/my-lib.esm.js', format: 'esm' },
    { file: 'dist/my-lib.cjs.js', format: 'cjs' },
    { file: 'dist/my-lib.umd.js', format: 'umd', name: 'MyLib' }
  ],
  plugins: [ resolve(), commonjs(), terser() ]
};
</code></pre>
          </details>

          <details>
            <summary>Tree-shaking & sideEffects</summary>
            <p>Rollup performs aggressive tree-shaking by default because it assumes ESM inputs. Avoid side-effectful module top-level code to let Rollup drop unused exports. Use package.json <code>sideEffects</code> properly for app bundles.</p>
          </details>

          <details>
            <summary>Advantages for libraries</summary>
            <ul>
              <li>Minimal runtime wrapper (smaller UMD).</li>
              <li>Better dead-code elimination for ESM.</li>
              <li>Clean multiple output formats from a single source.</li>
            </ul>
          </details>

          <details>
            <summary>Plugin ecosystem & useful plugins</summary>
            <ul>
              <li><code>@rollup/plugin-node-resolve</code> — resolve node_modules</li>
              <li><code>@rollup/plugin-commonjs</code> — convert CJS to ESM</li>
              <li><code>rollup-plugin-terser</code> — minify</li>
              <li><code>rollup-plugin-typescript2</code> — TypeScript support</li>
            </ul>
          </details>
        </section>

        <hr />

        <!-- PARCEL -->
        <section id="parcel" class="anchor-target">
          <h2>Parcel — zero-configuration builds</h2>

          <details>
            <summary>Executive summary</summary>
            <p>Parcel aims for zero-configuration. It detects entry points, file types, and necessary transforms automatically. It’s a great choice for prototypes, small apps, or teams that prefer convention over configuration.</p>
          </details>

          <details>
            <summary>Getting started & usage</summary>
            <pre><code class="language-bash"># install parcel
npm install -D parcel

# dev server
npx parcel src/index.html

# production build
npx parcel build src/index.html --dist-dir dist
</code></pre>
          </details>

          <details>
            <summary>How Parcel handles transforms</summary>
            <p>Parcel uses file-type based transformers and a plugin resolver. It automatically supports many assets (JS, CSS, images, WASM) and integrates with PostCSS, Babel, and TypeScript when it detects config files.</p>
          </details>

          <details>
            <summary>When to use Parcel</summary>
            <ul>
              <li>Rapid prototyping and demos</li>
              <li>Small to medium apps where team doesn't want to manage build config</li>
              <li>When you prefer fast setup and sensible defaults</li>
            </ul>
          </details>
        </section>

        <hr />

        <!-- VITE -->
        <section id="vite" class="anchor-target">
          <h2>Vite — fast development & modern tooling</h2>

          <details open>
            <summary>Executive summary</summary>
            <p>Vite provides a lightning-fast dev server using native ES modules in the browser and Rollup for production builds. Dev startup and HMR are very fast because Vite serves source files on demand and avoids bundling during development.</p>
          </details>

          <details>
            <summary>How Vite works (dev vs build)</summary>
            <ol>
              <li><strong>Dev:</strong> Vite starts a dev server and serves ESM modules directly to the browser. It transforms files on-demand via plugins, enabling near-instant cold start and fast HMR.</li>
              <li><strong>Build:</strong> Vite uses Rollup under the hood for production bundles and code-splitting.</li>
            </ol>
          </details>

          <details>
            <summary>Vite config example (vite.config.js)</summary>
            <pre><code class="language-javascript">import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  build: {
    target: 'es2018',
    outDir: 'dist',
    rollupOptions: {
      output: { manualChunks: { vendor: ['react','react-dom'] } }
    }
  }
})
</code></pre>
          </details>

          <details>
            <summary>Performance & HMR</summary>
            <p>Vite's HMR only updates changed modules, preserving state. Use esbuild-based transforms for TypeScript/JSX during dev and rely on Rollup for production tree-shaking and optimizations.</p>
          </details>

          <details>
            <summary>When to prefer Vite</summary>
            <ul>
              <li>Modern web apps needing fast dev feedback loops</li>
              <li>Framework integrations (React, Vue, Svelte)</li>
              <li>Teams that want great defaults with the option to customize build via Rollup</li>
            </ul>
          </details>
        </section>

        <hr />

        <!-- ESBUILD -->
        <section id="esbuild" class="anchor-target">
          <h2>ESBuild — speed-first bundler & transpiler</h2>

          <details>
            <summary>Executive summary</summary>
            <p>ESBuild is written in Go and focuses on extreme speed for bundling and transforming. It’s ideal for fast builds and incremental tooling. It lacks some advanced plugin hooks compared to Rollup or Webpack but integrations exist (esbuild-loader, plugins).</p>
          </details>

          <details>
            <summary>CLI & API examples</summary>
            <pre><code class="language-bash"># bundle with esbuild CLI
npx esbuild src/index.js --bundle --outfile=dist/bundle.js --minify --sourcemap

# Node API
const esbuild = require('esbuild');
esbuild.build({ entryPoints: ['src/index.js'], bundle: true, outfile: 'dist/bundle.js' });
</code></pre>
          </details>

          <details>
            <summary>esbuild trade-offs</summary>
            <ul>
              <li>Pro: extremely fast builds & transforms.</li>
              <li>Con: smaller plugin ecosystem and fewer advanced optimizations out-of-the-box.</li>
              <li>Use as dev-time transformer or in CI where speed matters; combine with Rollup for finely tuned production outputs if needed.</li>
            </ul>
          </details>
        </section>

        <hr />

        <!-- COMPARISONS -->
        <section id="comparisons" class="anchor-target">
          <h2>Comparisons & when to choose</h2>

          <details open>
            <summary>Quick comparison</summary>
            <table style="width:100%" class="table table-dark table-striped">
              <thead>
                <tr><th>Tool</th><th>Strength</th><th>Best for</th></tr>
              </thead>
              <tbody>
                <tr><td>Webpack</td><td>Flexible, plugin-rich</td><td>Complex apps requiring custom optimization</td></tr>
                <tr><td>Rollup</td><td>Small library bundles, tree-shaking</td><td>Libraries & tiny bundles</td></tr>
                <tr><td>Parcel</td><td>Zero config</td><td>Prototypes / quick apps</td></tr>
                <tr><td>Vite</td><td>Fast dev, great defaults</td><td>Modern apps / dev experience</td></tr>
                <tr><td>ESBuild</td><td>Speed</td><td>Dev tooling & quick builds</td></tr>
              </tbody>
            </table>
          </details>

          <details>
            <summary>Decision matrix</summary>
            <p>If you need production-grade fine-tuning and legacy support -> Webpack. If publishing a library -> Rollup. If you want fastest iteration during development -> Vite or esbuild. If you want minimal setup -> Parcel.</p>
          </details>
        </section>

        <hr />

        <!-- BEST PRACTICES -->
        <section id="bestpractices" class="anchor-target">
          <h2>Best practices & checklist</h2>

          <details>
            <summary>Checklist before shipping</summary>
            <ul>
              <li>Use content hashing for long-term caching.</li>
              <li>Ensure source maps are configured appropriately.</li>
              <li>Set <code>sideEffects:false</code> when safe for tree-shaking.</li>
              <li>Analyze bundles and remove large unused dependencies.</li>
              <li>Lazy-load heavy features and vendor libs.</li>
              <li>Automate build steps in CI and fail on large bundle regressions.</li>
            </ul>
          </details>

          <details>
            <summary>Security & supply chain</summary>
            <p>Lock dependency versions, use lockfiles, scan for vulnerabilities, audit third-party plugins, and be careful with plugins that execute native code or postinstall scripts.</p>
          </details>

          <details>
            <summary>Further reading & tools</summary>
            <ul>
              <li>webpack docs, Rollup docs, Vite docs, esbuild docs</li>
              <li>Bundlephobia, webpack-bundle-analyzer, source-map-explorer</li>
            </ul>
          </details>
        </section>

        <footer style="margin-top:20px;padding-bottom:40px;">
          <p class="muted">End of note. Use the left TOC to navigate, expand/collapse sections, and copy examples. Tell me which section you want deeper: plugin internals, CI caching, or example monorepo configs — I will extend this same file.</p>
        </footer>
      </article>
    </main>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/javascript.min.js"></script>
  <script>
    if(window.hljs){ hljs.highlightAll(); }

    document.querySelectorAll('#tocList a').forEach(a=>{
      a.addEventListener('click', function(e){ e.preventDefault(); const id=this.getAttribute('href').slice(1); const el=document.getElementById(id); if(el){ el.scrollIntoView({behavior:'smooth',block:'start'}); const d=el.querySelector('details'); if(d && !d.open) d.open=true; } });
    });

    document.getElementById('expandAll').addEventListener('click', ()=> document.querySelectorAll('details').forEach(d=> d.open=true));
    document.getElementById('collapseAll').addEventListener('click', ()=> document.querySelectorAll('details').forEach(d=> d.open=false));
    document.getElementById('tocReset').addEventListener('click', ()=> document.getElementById('content').scrollTo({top:0,behavior:'smooth'}));

    document.getElementById('tocSearch').addEventListener('input', ()=>{ const q=document.getElementById('tocSearch').value.trim().toLowerCase(); document.querySelectorAll('#tocList a').forEach(a=>{ a.style.display = a.textContent.toLowerCase().includes(q) ? 'block' : 'none'; }); });

    document.addEventListener('keydown',(e)=>{ if(e.key==='E' || e.key==='e') document.querySelectorAll('details').forEach(d=> d.open=true); if(e.key==='C' || e.key==='c') document.querySelectorAll('details').forEach(d=> d.open=false); });
  </script>
</body>
</html>