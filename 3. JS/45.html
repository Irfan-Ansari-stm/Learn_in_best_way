<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>14.3 – Symbols and Well-known Symbols</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
/* === BASE COLORS === */
:root{
  --bg-main:#050816;
  --bg-sidebar:#060b18;
  --accent-cyan:#22d3ee;
  --accent-amber:#fbbf24;
  --text-main:#e5e7eb;
  --text-muted:#9ca3af;
  --border-subtle:#1f2937;
  --code-bg:#020617;
}

/* === GLOBAL === */
*{box-sizing:border-box;}
html,body{
  margin:0;
  padding:0;
  height:100%;
  background:var(--bg-main);
  color:var(--text-main);
  font-family:system-ui, sans-serif;
  scroll-behavior:smooth;
}
body{overflow:hidden;}

/* === LAYOUT === */
.app-wrapper{height:100vh;}
.sidebar{
  background:radial-gradient(circle at top left,#0f172a,var(--bg-sidebar));
  border-right:1px solid var(--border-subtle);
  padding:1.2rem 1rem;
  height:100vh;
  overflow-y:auto;
}
.content{
  padding:1.5rem 2rem;
  height:100vh;
  overflow-y:auto;
}

/* Scrollbars */
.sidebar::-webkit-scrollbar,
.content::-webkit-scrollbar{width:8px;}
.sidebar::-webkit-scrollbar-thumb,
.content::-webkit-scrollbar-thumb{
  background:#1f2937;border-radius:10px;
}

/* Sidebar typography */
.main-title{color:var(--accent-cyan);font-size:1.4rem;font-weight:700;}
.subtitle{color:var(--text-muted);font-size:0.9rem;}
.meta{font-size:0.8rem;color:var(--text-muted);}

/* TOC */
.toc-card{
  background:rgba(15,23,42,0.95);
  border-radius:0.7rem;
  padding:0.9rem;
  border:1px solid #1e293b;
  margin-top:0.8rem;
}
.toc-title{color:var(--accent-amber);font-weight:600;font-size:0.9rem;}
.toc-search input{
  width:100%;
  background:#020617;
  border:1px solid #0f172a;
  color:var(--text-main);
  font-size:0.78rem;
  border-radius:999px;
  padding:0.2rem 0.6rem;
}
.toc-list{list-style:none;margin:0;padding:0;}
.toc-link{
  display:flex;align-items:center;gap:0.4rem;
  text-decoration:none;
  padding:0.2rem 0.4rem;
  color:var(--text-muted);
  border-radius:0.4rem;
  font-size:0.8rem;
}
.toc-link-dot{width:6px;height:6px;border-radius:50%;background:#64748b;}
.toc-link:hover{background:#0f172a;color:var(--accent-cyan);}
.toc-link.active{background:#082f49;color:var(--accent-cyan);}
.toc-link.active .toc-link-dot{background:var(--accent-cyan);}

/* Buttons */
button{
  background:none;
  border:1px solid var(--border-subtle);
  border-radius:999px;
  color:var(--text-muted);
  padding:3px 10px;
  font-size:0.75rem;
}

/* Content headings */
h1{color:var(--accent-cyan);font-size:1.6rem;}
h2{color:var(--accent-amber);font-size:1.1rem;margin-top:1.4rem;}

.summary-strip{
  background:rgba(56,189,248,0.15);
  border:1px solid rgba(148,163,184,0.4);
  border-radius:0.8rem;
  padding:0.8rem 1rem;
  margin-bottom:1rem;
  font-size:0.86rem;
}

/* DETAILS */
details{
  background:#0f172a;
  border:1px solid #1e3a8a;
  border-radius:0.7rem;
  padding:0.4rem 0.7rem;
  margin-bottom:0.9rem;
}
details[open]{border-color:#38bdf8;}
summary{
  cursor:pointer;
  font-weight:600;
  color:var(--accent-amber);
  padding:0.3rem 0;
}
.inner{font-size:0.84rem;color:var(--text-muted);}
.inner ul{padding-left:1.2rem;}

/* CODE BLOCKS */
pre{
  background:var(--code-bg);
  border:1px solid #0e7e7e;
  border-radius:0.7rem;
  padding:0.7rem;
  overflow-x:auto;
  margin:0.5rem 0;
}
code{
  font-family:"JetBrains Mono", monospace;
  font-size:0.82rem;
}

/* Syntax colors */
.token-comment{color:#6b7280;font-style:italic;}
.token-string{color:#fb923c;}
.token-number{color:#a855f7;}
.token-keyword{color:#22c55e;font-weight:600;}
.token-builtin{color:#facc15;}
.token-fn{color:#38bdf8;}

</style>
</head>

<body>

<div class="container-fluid app-wrapper">
<div class="row flex-nowrap">

<!-- SIDEBAR -->
<aside class="col-12 col-md-4 col-lg-3 sidebar">

  <div class="main-title">14.3 – Symbols & Well-known Symbols</div>
  <div class="subtitle">ES6 symbol primitives, iteration & meta-programming</div>
  <div class="meta">Prepared for: College → Master → PhD • Deep learning mode</div>

  <div class="toc-card">
    <div class="toc-title">On this page</div>
    <div class="toc-search"><input id="tocSearch" placeholder="Search sections..."></div>

    <ul id="tocList" class="toc-list">
      <li><a href="#sec-symbol-type" class="toc-link"><span class="toc-link-dot"></span>14.3.1 Symbol Primitive Type</a></li>
      <li><a href="#sec-symbol-for" class="toc-link"><span class="toc-link-dot"></span>14.3.2 Symbol.for() and Symbol.keyFor()</a></li>
      <li><a href="#sec-well-known" class="toc-link"><span class="toc-link-dot"></span>14.3.3 Well-known Symbols</a></li>
      <li><a href="#sec-iterator" class="toc-link"><span class="toc-link-dot"></span>14.3.4 Symbol.iterator & Iteration Protocol</a></li>
      <li><a href="#sec-private-sim" class="toc-link"><span class="toc-link-dot"></span>14.3.5 Private Property Simulation</a></li>
    </ul>

    <div class="mt-2">
      <button onclick="expandAll()">Expand all</button>
      <button onclick="collapseAll()">Collapse all</button>
    </div>
  </div>

</aside>

<!-- CONTENT -->
<main class="col content">

  <h1>14.3 – Symbols & Well-known Symbols in JavaScript</h1>

  <div class="summary-strip">
    <strong>Executive Summary:</strong>  
    A <code>Symbol</code> is a unique & immutable primitive value used to create non-colliding object keys.
    Symbol keys are not enumerable by default, making them ideal for internal metadata,
    private-like fields, or extension hooks. Well-known symbols customize JavaScript
    behaviours such as iteration, coercion, async operations & object interactions.
  </div>

  <!-- 14.3.1 -->
  <section id="sec-symbol-type">
    <h2>14.3.1 Symbol Primitive Type</h2>

    <details open>
      <summary>Understanding Symbol: A unique primitive</summary>
      <div class="inner">
        <p>A Symbol is a primitive that guarantees uniqueness:</p>

<pre><code>
const s1 = Symbol("id");
const s2 = Symbol("id");

console.log(s1 === s2); // false (always unique)
</code></pre>

        <p>Symbols are ideal for metadata keys:</p>

<pre><code>
const META = Symbol("meta");

const obj = {
    [META]: { createdBy: "Irfan", time: Date.now() }
};

console.log(obj[META]); // hidden internal value
</code></pre>
      </div>
    </details>

    <details>
      <summary>Symbols are skipped by for...in, Object.keys()</summary>
      <div class="inner">
<pre><code>
const SECRET = Symbol("secret");

const user = {
    name: "Irfan",
    [SECRET]: "xyz"
};

console.log(Object.keys(user));     // ["name"]
console.log(user[SECRET]);          // "xyz"
console.log(SECRET in user);        // true
</code></pre>
      </div>
    </details>
  </section>

  <!-- 14.3.2 -->
  <section id="sec-symbol-for">
    <h2>14.3.2 Symbol.for() and Symbol.keyFor()</h2>

    <details open>
      <summary>Global Symbol Registry</summary>
      <div class="inner">
        <p><code>Symbol.for()</code> returns the same symbol for the same key across your entire application:</p>

<pre><code>
const a = Symbol.for("token");
const b = Symbol.for("token");

console.log(a === b); // true
</code></pre>

<pre><code>
console.log(Symbol.keyFor(a)); // "token"
</code></pre>
      </div>
    </details>

    <details>
      <summary>Difference between Symbol() and Symbol.for()</summary>
      <div class="inner">
<pre><code>
// NEW unique symbol every time
Symbol("x") !== Symbol("x")

// Shared registry
Symbol.for("x") === Symbol.for("x")
</code></pre>
      </div>
    </details>
  </section>

  <!-- 14.3.3 -->
  <section id="sec-well-known">
    <h2>14.3.3 Well-known Symbols</h2>

    <details open>
      <summary>What are well-known symbols?</summary>
      <div class="inner">
        <p>
          JavaScript exposes built-in symbols that customize language behaviours.
        </p>
        <ul>
          <li><code>Symbol.iterator</code> – iteration protocol</li>
          <li><code>Symbol.asyncIterator</code> – async iteration</li>
          <li><code>Symbol.toPrimitive</code> – type coercion</li>
          <li><code>Symbol.hasInstance</code> – <code>instanceof</code> behaviour</li>
          <li><code>Symbol.toStringTag</code> – custom tag in <code>Object.prototype.toString</code></li>
          <li><code>Symbol.isConcatSpreadable</code> – controls array merge behaviour</li>
        </ul>
      </div>
    </details>

    <details>
      <summary>Example: Custom instanceof using Symbol.hasInstance</summary>
      <div class="inner">
<pre><code>
class Even {
    static [Symbol.hasInstance](v) {
        return typeof v === "number" && v % 2 === 0;
    }
}

console.log(6 instanceof Even); // true
console.log(7 instanceof Even); // false
</code></pre>
      </div>
    </details>

    <details>
      <summary>Example: Custom toString display using Symbol.toStringTag</summary>
      <div class="inner">
<pre><code>
const user = {
    name: "Irfan",
    [Symbol.toStringTag]: "UserObject"
};

console.log(Object.prototype.toString.call(user));
// "[object UserObject]"
</code></pre>
      </div>
    </details>
  </section>

  <!-- 14.3.4 -->
  <section id="sec-iterator">
    <h2>14.3.4 Symbol.iterator & Iteration Protocol</h2>

    <details open>
      <summary>Implementing custom iteration</summary>
      <div class="inner">
<pre><code>
const range = {
    start: 1,
    end: 5,
    [Symbol.iterator]() {
        let current = this.start;
        const end = this.end;
        return {
            next() {
                if (current <= end) {
                    return { value: current++, done: false };
                }
                return { done: true };
            }
        };
    }
};

for (const n of range) {
    console.log(n);
}
</code></pre>
      </div>
    </details>

    <details>
      <summary>Turning object into an iterable view</summary>
      <div class="inner">
<pre><code>
const obj = {
  a: 10,
  b: 20,
  c: 30,
  [Symbol.iterator]() {
    const entries = Object.entries(this);
    let i = 0;
    return {
      next() {
        return i < entries.length
          ? { value: entries[i++], done:false }
          : { done:true };
      }
    }
  }
};

for (const [k,v] of obj) {
  console.log(k, v);
}
</code></pre>
      </div>
    </details>
  </section>

  <!-- 14.3.5 -->
  <section id="sec-private-sim">
    <h2>14.3.5 Private Property Simulation with Symbols</h2>

    <details open>
      <summary>Symbols hide properties from enumeration</summary>
      <div class="inner">
<pre><code>
const _secret = Symbol("secret");

class User {
  constructor(name, secret){
    this.name = name;
    this[_secret] = secret; // private-like
  }
}

const u = new User("Irfan","myPassword");

console.log(Object.keys(u)); // ["name"]
console.log(u[_secret]);     // "myPassword"
</code></pre>

<p>Perfect for framework-internal metadata.</p>
      </div>
    </details>

    <details>
      <summary>Simulating multiple private channels</summary>
      <div class="inner">
<pre><code>
const PRIV = {
  score: Symbol("score"),
  token: Symbol("token")
};

class Player {
  constructor() {
    this[PRIV.score] = 0;
    this[PRIV.token] = Math.random().toString(36).slice(2);
  }
}

const p = new Player();
console.log(p[PRIV.score]);
console.log(Object.keys(p));  // []
</code></pre>
      </div>
    </details>

  </section>

</main>

</div>
</div>

<script>
// Expand/collapse all
function expandAll(){document.querySelectorAll("details").forEach(d=>d.open=true);}
function collapseAll(){document.querySelectorAll("details").forEach(d=>d.open=false);}

// TOC active highlight + scroll
document.addEventListener("DOMContentLoaded",()=>{
  const content=document.querySelector(".content");
  const tocLinks=[...document.querySelectorAll(".toc-link")];
  const sections=tocLinks.map(link=>{
    return{
      link,
      target:document.querySelector(link.getAttribute("href"))
    };
  });

  content.addEventListener("scroll",()=>{
    const y=content.scrollTop;
    let current=null;
    sections.forEach(({link,target})=>{
      if(target.offsetTop-80<=y) current=link;
    });
    tocLinks.forEach(l=>l.classList.remove("active"));
    if(current) current.classList.add("active");
  });

  // TOC search
  const search=document.getElementById("tocSearch");
  const tocItems=[...document.querySelectorAll("#tocList li")];
  search.addEventListener("input",()=>{
    const q=search.value.toLowerCase();
    tocItems.forEach(li=>{
      li.style.display=li.textContent.toLowerCase().includes(q)?"":"none";
    });
  });

  // Basic syntax highlighting
  function escHTML(s){return s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");}

  const keywords=["class","constructor","return","if","else","for","while","new","function","const","let","var"];
  const builtins=["Symbol","Object","Array","Map","Set","Date","Promise","Reflect"];
  document.querySelectorAll("pre code").forEach(block=>{
    let html=escHTML(block.textContent);

    html=html.replace(/(\/\/.*?$)/gm,"<span class='token-comment'>$1</span>");
    html=html.replace(/(&quot;.*?&quot;|'.*?'|`.*?`)/g,"<span class='token-string'>$1</span>");
    html=html.replace(/\b(\d+)\b/g,"<span class='token-number'>$1</span>");
    
    builtins.forEach(b=>{
      html=html.replace(new RegExp("\\b"+b+"\\b","g"),"<span class='token-builtin'>"+b+"</span>");
    });
    keywords.forEach(k=>{
      html=html.replace(new RegExp("\\b"+k+"\\b","g"),"<span class='token-keyword'>"+k+"</span>");
    });
    html=html.replace(/([a-zA-Z_$][\w$]*)(?=\()/g,"<span class='token-fn'>$1</span>");

    block.innerHTML=html;
  });

});
</script>

</body>
</html>
